<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Honeymoon Guide</title>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" type="image/jpeg" href="favicon.jpg">
</head>

<body>

    <h1>Honeymoon User Guide</h1>

    <!-- Tutorial GIF -->
    <div style="text-align: center; margin-bottom: 20px;">
        <img src="tutorial.gif" alt="Tutorial GIF" style="max-width: 100%; border: 4px ridge #8A2BE2;">
    </div>

    <!-- Browser Dojo Game -->
    <div id="game-container">
        <div class="level-info" id="level-info">Loading Dojo...</div>
        <div id="game-screen"></div>
        <div style="margin-top: 10px; font-size: 0.8em; color: #888;">Cannot type? Click here to focus.</div>
    </div>

    <script>
        const levels = [
            {
                task: "Mission 1: Move cursor to the END of the line (Ctrl + E)",
                text: "The treasure is at the end",
                check: (state) => state.col === state.text.length,
                confetti: "Nice! End of line reached."
            },
            {
                task: "Mission 2: Move cursor to the START of the line (Ctrl + A)",
                text: "The treasure is at the end",
                setup: (state) => state.col = state.text.length,
                check: (state) => state.col === 0,
                confetti: "Boom! Back to start."
            },
            {
                task: "Mission 3: Kill the word 'Bad' (Alt + D)",
                text: "Good Bad Ugly",
                setup: (state) => state.col = 5,
                check: (state) => state.text === "Good  Ugly",
                confetti: "Deleted! 'Bad' is gone."
            },
            {
                task: "Mission 4: Kill to end of line (Ctrl + K)",
                text: "Keep this. Delete that.",
                setup: (state) => state.col = 11,
                check: (state) => state.text === "Keep this. ",
                confetti: "Clean sweep!"
            },
            {
                task: "Mission 5: Fix the typo (Ctrl + T)",
                text: "Teh quick brown fox",
                setup: (state) => state.col = 3,
                check: (state) => state.text === "The quick brown fox",
                confetti: "Transposed! No more typos."
            },
            {
                task: "Dojo Complete! You are a Honeymoon Master.",
                text: "Press any key to restart.",
                check: (state) => false,
                confetti: "GG WP"
            }
        ];

        let currentLevel = 0;
        let state = { text: "", col: 0 };
        const screen = document.getElementById('game-screen');
        const info = document.getElementById('level-info');
        const container = document.getElementById('game-container');

        // Initial setup
        function loadLevel(n) {
            if (n >= levels.length) n = 0;
            currentLevel = n;
            let lvl = levels[currentLevel];
            state.text = lvl.text;
            state.col = 0;
            if (lvl.setup) lvl.setup(state);
            render();
            info.innerText = lvl.task;
        }

        function render() {
            let html = "";
            for (let i = 0; i < state.text.length; i++) {
                if (i === state.col) html += '<span class="cursor">' + state.text[i] + '</span>';
                else html += state.text[i];
            }
            if (state.col === state.text.length) html += '<span class="cursor">&nbsp;</span>';
            screen.innerHTML = html;
        }

        function checkWin() { // Simple check
            if (levels[currentLevel].check(state)) {
                info.innerText = levels[currentLevel].confetti;
                info.style.color = "#ffff00";
                setTimeout(() => {
                    info.style.color = "#33ff33";
                    loadLevel(currentLevel + 1);
                }, 1500);
            }
        }

        container.addEventListener('click', () => container.focus());
        container.setAttribute('tabindex', '0'); // Make focusable

        container.addEventListener('keydown', (e) => {
            e.preventDefault();
            if (currentLevel === levels.length - 1) { loadLevel(0); return; }

            // Emacs / Honeymoon bindings simulation
            if (e.ctrlKey) {
                switch (e.key.toLowerCase()) {
                    case 'a': state.col = 0; break;
                    case 'e': state.col = state.text.length; break;
                    case 'f': state.col = Math.min(state.text.length, state.col + 1); break;
                    case 'b': state.col = Math.max(0, state.col - 1); break;
                    case 'k': state.text = state.text.substring(0, state.col); break;
                    case 'd': // Delete char
                        state.text = state.text.slice(0, state.col) + state.text.slice(state.col + 1);
                        break;
                    case 't': // Transpose
                        if (state.col > 0 && state.col < state.text.length) {
                            let arr = state.text.split('');
                            let temp = arr[state.col - 1];
                            arr[state.col - 1] = arr[state.col];
                            arr[state.col] = temp;
                            state.text = arr.join('');
                            state.col++;
                        }
                        break;
                }
            } else if (e.altKey) {
                switch (e.key.toLowerCase()) {
                    case 'f': // Forward word
                        while (state.col < state.text.length && state.text[state.col] === ' ') state.col++;
                        while (state.col < state.text.length && state.text[state.col] !== ' ') state.col++;
                        break;
                    case 'b': // Back word
                        while (state.col > 0 && state.text[state.col - 1] === ' ') state.col--;
                        while (state.col > 0 && state.text[state.col - 1] !== ' ') state.col--;
                        break;
                    case 'd': // Kill word
                        let end = state.col;
                        while (end < state.text.length && state.text[end] === ' ') end++;
                        while (end < state.text.length && state.text[end] !== ' ') end++;
                        state.text = state.text.slice(0, state.col) + state.text.slice(end);
                        break;
                }
            } else {
                if (e.key === "ArrowRight") state.col = Math.min(state.text.length, state.col + 1);
                else if (e.key === "ArrowLeft") state.col = Math.max(0, state.col - 1);
            }

            render();
            checkWin();
        });

        loadLevel(0);
    </script>

    <div class="nav">
        <a href="index.html" class="button">Home</a>
        <a href="tutorial.html" class="button">Guide</a>
        <a href="internals.html" class="button">Internals</a>
        <a href="https://github.com/mooofin/honeymoon" class="button">Source Code</a>
    </div>

    <br>

    <div style="max-width: 800px; margin: 0 auto; text-align: left;">
        <p>Honeymoon uses Emacs-style keybindings for maximum efficiency. Keep your hands on the home row.</p>

        <h2>Search & Navigation</h2>
        <ul>
            <li><span class="key">Ctrl</span> + <span class="key">S</span> : Incremental search forward</li>
            <li><span class="key">Ctrl</span> + <span class="key">R</span> : Incremental search backward</li>
            <li><span class="key">Alt</span> + <span class="key">G</span> then <span class="key">G</span> : Go to
                line</li>
        </ul>

        <h2>Word & Line Movement</h2>
        <ul>
            <li><span class="key">Alt</span> + <span class="key">B</span> : Move backward one word</li>
            <li><span class="key">Alt</span> + <span class="key">F</span> : Move forward one word</li>
            <li><span class="key">Ctrl</span> + <span class="key">A</span> : Move to beginning of line</li>
            <li><span class="key">Ctrl</span> + <span class="key">E</span> : Move to end of line</li>
            <li><span class="key">Ctrl</span> + <span class="key">P</span> : Move Up</li>
            <li><span class="key">Ctrl</span> + <span class="key">N</span> : Move Down</li>
            <li><span class="key">Ctrl</span> + <span class="key">B</span> : Move Left</li>
            <li><span class="key">Ctrl</span> + <span class="key">F</span> : Move Right</li>
        </ul>

        <h2>Killing (Cut/Delete)</h2>
        <ul>
            <li><span class="key">Ctrl</span> + <span class="key">K</span> : Kill from cursor to end of line</li>
            <li><span class="key">Alt</span> + <span class="key">D</span> : Kill next word</li>
            <li><span class="key">Ctrl</span> + <span class="key">W</span> : Kill selection (Cut)</li>
            <li><span class="key">Backspace</span> : Delete backward</li>
            <li><span class="key">Del</span> : Delete forward</li>
        </ul>

        <h2>Undo / Redo</h2>
        <ul>
            <li><span class="key">Ctrl</span> + <span class="key">/</span> : Undo</li>
            <li><span class="key">Ctrl</span> + <span class="key">G</span> : Cancel current command</li>
            <li><span class="key">Ctrl</span> + <span class="key">Shift</span> + <span class="key">/</span> : Redo
            </li>
        </ul>

        <h2>Buffers & Files</h2>
        <ul>
            <li><span class="key">Ctrl</span> + <span class="key">X</span> then <span class="key">Ctrl</span> + <span
                    class="key">F</span> : Open file</li>
            <li><span class="key">Ctrl</span> + <span class="key">X</span> then <span class="key">B</span> : Switch
                buffer</li>
            <li><span class="key">Ctrl</span> + <span class="key">X</span> then <span class="key">K</span> : Close
                buffer</li>
            <li><span class="key">Ctrl</span> + <span class="key">X</span> then <span class="key">Ctrl</span> + <span
                    class="key">S</span> : Save file</li>
            <li><span class="key">Ctrl</span> + <span class="key">X</span> then <span class="key">Ctrl</span> + <span
                    class="key">C</span> : Quit</li>
        </ul>

        <h2>Selection & Clipboard</h2>
        <ul>
            <li><span class="key">Ctrl</span> + <span class="key">Space</span> : Set Mark (Start Selection)</li>
            <li><span class="key">Ctrl</span> + <span class="key">X</span> then <span class="key">H</span> : Select all
            </li>
            <li><span class="key">Alt</span> + <span class="key">H</span> : Select paragraph</li>
            <li><span class="key">Esc</span> then <span class="key">W</span> : Copy selection</li>
            <li><span class="key">Ctrl</span> + <span class="key">Y</span> : Paste (Yank)</li>
        </ul>

        <h2>Indentation & Formatting</h2>
        <ul>
            <li><span class="key">Tab</span> : Indent line / selection</li>
            <li><span class="key">Shift</span> + <span class="key">Tab</span> : Unindent</li>
            <li><span class="key">Ctrl</span> + <span class="key">X</span> then <span class="key">Tab</span> : Auto
                format buffer</li>
        </ul>

        <h2>Misc Power Moves</h2>
        <ul>
            <li><span class="key">Ctrl</span> + <span class="key">L</span> : Recenter screen</li>
            <li><span class="key">Ctrl</span> + <span class="key">T</span> : Transpose characters</li>
            <li><span class="key">Alt</span> + <span class="key">T</span> : Transpose words</li>
        </ul>

        <h2>Help & Escape</h2>
        <ul>
            <li><span class="key">Ctrl</span> + <span class="key">H</span> then <span class="key">K</span> : Describe
                key</li>
            <li><span class="key">Ctrl</span> + <span class="key">H</span> then <span class="key">F</span> : Describe
                function</li>
            <li><span class="key">Ctrl</span> + <span class="key">G</span> : Universal escape (Cancel)</li>
        </ul>

    </div>

    <div class="footer">
        <a href="https://github.com/mooofin">Contact the Author (mooofin)</a>
    </div>
</body>

</html>